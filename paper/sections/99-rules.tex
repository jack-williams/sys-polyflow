\section{Rules}

\subsection{Typing Relation}

\begin{mathpar}

\inferrule*[right=T-True]
           {  }
           { \hastype{\Gamma}{\true}{\tbool} }

\inferrule*[right=T-False]
           {  }
           { \hastype{\Gamma}{\false}{\tbool} }

\inferrule*[right=T-Var]
           { \typeincontext{x}{T}{\Gamma} }
           { \hastype{\Gamma}{x}{T} }

\inferrule*[right=T-Abs]
           { \hastype{\extendwtype{\Gamma}{x}{T_1}}{t_2}{T_2} }
           { \hastype{\Gamma}{\abs{x}{T_1}{t_2}}{\fun{T_1}{T_2}} }

\inferrule*[right=T-App]
           { \hastype{\extendwsubtype{\Gamma}{X}{T_1}}{t_2}{T_2} \\ \hastype{\Gamma}{t_2}{T_{11}} }
           { \hastype{\Gamma}{\app{t_1}{t_2}}{T_{12}} }

\inferrule*[right=T-TAbs]
           { \hastype{\extendwsubtype{\Gamma}{X}{T_1}}{t_2}{T_2} }
           { \hastype{\Gamma}{(\tabs{X}{T_1}{t_2})}{(\tfun{X}{T_1}{T_2})} }

\inferrule*[right=T-TApp]
           { \hastype{\Gamma}{t_1}{\tfun{X}{T_{11}}{T_{12}}} \\ \hassubtype{\Gamma}{T_2}{T_{11}} }
           { \hastype{\Gamma}{\tapp{t_1}{T_2}}{\subst{T_{12}}{X}{T_2}} }

\inferrule*[right=T-Sub]
           { \hastype{\Gamma}{t}{S} \\ \hassubtype{\Gamma}{S}{T} }
           { \hastype{\Gamma}{t}{T} }

\inferrule*[right=T-Eq]
           { \hastype{\Gamma}{t_1}{T} \\ \hastype{\Gamma}{t_2}{T} }
           { \hastype{\Gamma}{\eq{t_1}{t_2}}{\tbool} }

\inferrule*[right=T-If]
           { \hastype{\Gamma}{t_1}{\tbool} \\ \hastype{\Gamma}{t_2}{T} \\ \hastype{\Gamma}{t_3}{T} }
           { \hastype{\Gamma}{\ite{t_1}{t_2}{t_3}}{T} }

\inferrule*[right=T-IfTrueR]
           { \hastype{\Gamma}{x}{X} \\ \hastype{\extendwsupertype{\Gamma}{X}{\tbool}}{t_2}{T} \\ \hastype{\extendwsupertype{\Gamma}{X}{\tbool}}{t_3}{T} }
           { \hastype{\Gamma}{\ite{\eq{x}{\true}}{t_2}{t_3}}{T} }

\inferrule*[right=T-Map]
           { \hassubtype{\Gamma}{T}{\tbool} \\ \nothassubtype{\Gamma}{T}{\ttrue} \\ \nothassubtype{\Gamma}{T}{\tfalse} \\ \nothassubtype{\Gamma}{\ttrue}{T} \\ \nothassubtype{\Gamma}{\tfalse}{T} }
           { \hastype{\Gamma}{\tmap{T_1}{T_2}{T}}{\union{T_1}{T_2}} }

\inferrule*[right=T-MapTrueSub]
           { \hassubtype{\Gamma}{T}{\ttrue} }
           { \hastype{\Gamma}{\tmap{T_1}{T_2}{T}}{T_1} }

\inferrule*[right=T-MapFalseSub]
           { \hassubtype{\Gamma}{T}{\tfalse} }
           { \hastype{\Gamma}{\tmap{T_1}{T_2}{T}}{T_2} }

\inferrule*[right=T-MapTrueSup]
           { \hassubtype{\Gamma}{\ttrue}{T} }
           { \hastype{\Gamma}{\tmap{T_1}{T_2}{T}}{T_1} }

\inferrule*[right=T-MapFalseSup]
           { \hassubtype{\Gamma}{\tfalse}{T} }
           { \hastype{\Gamma}{\tmap{T_1}{T_2}{T}}{T_2} }



\end{mathpar}

\subsection{Sub-Typing Relation}

\begin{mathpar}

\inferrule*[right=S-Refl]
           {  }
           { \hassubtype{\Gamma}{S}{S} }

\inferrule*[right=S-Trans]
           { \hassubtype{\Gamma}{S}{U} \\ \hassubtype{\Gamma}{U}{T} }
           { \hassubtype{\Gamma}{S}{T} }

           \inferrule*[right=S-Top]
           {  }
           { \hassubtype{\Gamma}{S}{Top} }

\inferrule*[right=S-TVarSub]
           { \subtypeincontext{X}{T}{\Gamma} }
           { \hassubtype{\Gamma}{X}{T} }

\inferrule*[right=S-TVarSup]
           { \supertypeincontext{X}{T}{\Gamma} }
           { \hassubtype{\Gamma}{T}{X} }

\inferrule*[right=S-Arrow]
           { \hassubtype{\Gamma}{T_1}{S_1} \\ \hassubtype{\Gamma}{S_2}{T_2} }
           { \hassubtype{\Gamma}{(\fun{S_1}{S_2})}{(\fun{T_1}{T_2})} }

\inferrule*[right=S-All]
           { \hassubtype{\extendwsubtype{\Gamma}{X}{U_1}}{S_2}{T_2}}
           { \hassubtype{\Gamma}{(\tfun{X}{U_1}{S_2})}{(\tfun{X}{U_1}{T_2})} }

\inferrule*[right=S-True]
           {  }
           { \hassubtype{\Gamma}{\ttrue}{\tbool} }

\inferrule*[right=S-False]
           {  }
           { \hassubtype{\Gamma}{\tfalse}{\tbool} }

\inferrule*[right=S-UnionL]
           {  }
           { \hassubtype{\Gamma}{A}{\union{A}{B}} }

\inferrule*[right=S-UnionR]
           {  }
           { \hassubtype{\Gamma}{B}{\union{A}{B}} }

\end{mathpar}
